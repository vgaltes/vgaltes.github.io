---
layout: post
status: publish
published: true
title: The value of this in JavaScript
author:
  display_name: vgaltesc
  login: vgaltesc
  email: vincentredrum@gmail.com
  url: ''
author_login: vgaltesc
author_email: vincentredrum@gmail.com
wordpress_id: 241
wordpress_url: http://vgaltes.com/?p=241
date: '2015-03-29 16:36:44 +0100'
date_gmt: '2015-03-29 16:36:44 +0100'
categories:
- Javascript
tags:
- javascript
- this
comments: []
---
<p>What object references <em>this</em> in JavaScript is always a tricky question. Let me try to explain you how the value of <em>this</em> is determined.</p>
<p>The value of <em>this</em> is based on the context in which the function is being called. Let's consider this piece of code:</p>
<pre class="brush:javascript">&lt;script&gt;
 
var hello = 'Hello from the outer space';
var aObject = {
	hello : 'Hello from the earth'
}
 
var sayHello = function(){
	console.log(this.hello);
}
 
aObject.sayHello = sayHello;
 
aObject.sayHello();
sayHello();
 
&lt;/script&gt;</pre>
<p>The output of this code is this:</p>
<p>[caption id="attachment_244" align="alignnone" width="1024"]<a href="http://vgaltes.com/wp-content/uploads/2015/03/This1.png"><img class="size-large wp-image-244" src="http://vgaltes.com/wp-content/uploads/2015/03/This1-1024x223.png" alt="First example" width="1024" height="223" /></a> First example[/caption]</p>
<p>As you can see, in the first line we are calling the <em>sayHello</em> function inside the object, so <em>this</em> is referencing aObject. In the second line, we are calling the <em>sayHello</em> function of the global scope.</p>
<h2>Nested functions</h2>
<p>Things get a little more complicated when you have nested functions. Imagine this piece of code:</p>
<pre class="brush:javascript">&lt;script&gt;
 
var aObject = {
	aFunction: function(){
		console.log(this);
		var anotherFunction = function(){
			console.log(this);
			var yetAnotherFunction = function(){
				console.log(this);
			}();
		}();
	}
}
 
aObject.aFunction();
 
&lt;/script&gt;</pre>
<p>The output of this code is:</p>
<p>[caption id="attachment_245" align="alignnone" width="1024"]<a href="http://vgaltes.com/wp-content/uploads/2015/03/This2.png"><img class="size-large wp-image-245" src="http://vgaltes.com/wp-content/uploads/2015/03/This2-1024x204.png" alt="Nested functions" width="1024" height="204" /></a> Nested functions[/caption]</p>
<p>As you can see, only the first call <em>this</em> refers to the object. On the other calls, <em>this</em> refers to the head object. This will be fixed soon, but in the meantime you should workaround this problem storing <em>this</em> in a variable:</p>
<pre class="brush:javascript">&lt;script&gt;
 
var aObject = {
	aFunction: function(){
		console.log(this);
		var that = this;
		var anotherFunction = function(){
			console.log(that);
			var yetAnotherFunction = function(){
				console.log(that);
			}();
		}();
	}
}
 
aObject.aFunction();
 
&lt;/script&gt;</pre>
<p>&nbsp;</p>
<h2>Constructors</h2>
<p>When you invoke a function with the <em>new</em> keyword <em>this</em> refers to the instance.</p>
<p>Imagine this piece of code:</p>
<pre class="brush:javascript">&lt;script&gt;
 
var Elf = function(name){
	this.name = name;
}
 
var aegnor = new Elf('Aegnor');
 
console.log(agnor.name);
 
&lt;/script&gt;</pre>
<p>The output will be:</p>
<p>Be careful because if you don't use the <em>new</em> keyword, <em>this</em> will refer to the context in which Country is invoked. So, if we remove the keyword <em>new</em> of the previous example, the output will be <em>undefined</em>.</p>
<p>The same logic applies if you add a function to the object prototype. If you new an instance of this function and you call the added function which uses <em>this</em>, <em>this</em> will refer to the instance.</p>
<h2>Using call or apply</h2>
<p>You can overwrite the value of <em>this</em> using <em>apply()</em> or <em>call()</em>. When using these functions you specify which object will be used as <em>this</em>. Let's see an example:</p>
<p>&nbsp;</p>
<pre class="brush:javascript">&lt;script&gt;
 
var monica = {};

var setLocation = function(location){
    this.location = location;
}

setLocation.apply(monica, ['London']);

console.log(monica);
 
&lt;/script&gt;</pre>
<p>The output is:</p>
<p>[caption id="attachment_248" align="alignnone" width="725"]<a href="http://vgaltes.com/wp-content/uploads/2015/03/This4.png"><img class="size-full wp-image-248" src="http://vgaltes.com/wp-content/uploads/2015/03/This4.png" alt="Using apply" width="725" height="223" /></a> Using apply[/caption]</p>
<p>&nbsp;</p>
<p>As you can see, determine the value of this is a little bit tricky but not so complicated.</p>
