---
layout: post
status: publish
published: true
title: Introducing IoCTesting
author:
  display_name: vgaltesc
  login: vgaltesc
  email: vincentredrum@gmail.com
  url: ''
author_login: vgaltesc
author_email: vincentredrum@gmail.com
wordpress_id: 226
wordpress_url: http://vgaltes.com/?p=226
date: '2015-02-09 21:23:17 +0000'
date_gmt: '2015-02-09 20:23:17 +0000'
categories:
- Testing
- ".Net"
tags:
- IoC
- Unit Testing
- StructureMap
- Unity
comments: []
---
<p>Last week I've worked in a tiny library to test if you have configured all the dependencies in your code in the <a title="Inversion of Control" href="http://en.wikipedia.org/wiki/Inversion_of_control" target="_blank">IoC</a> container. I borrowed the idea from this <a title="Usando tests para validar convenciones" href="http://blog.koalite.com/2013/12/usando-tests-para-validar-convenciones/" target="_blank">post </a>from <a title="Juan Maria Hernandez" href="https://twitter.com/gulnor" target="_blank">Juan María Hernández</a>. The idea is simple, but it can save you some time of debugging.</p>
<p>Install the library is quite straightforward: just install the <a title="IoC NuGet packages" href="https://www.nuget.org/packages?q=ioctesting" target="_blank">NuGet package</a> you need depending on the container you are using:</p>
<pre class="brush:other">install-package IoCTesting.StructureMap
install-package IoCTesting.Unity</pre>
<p>To be able to use the library you need to have a method that returns the container. If you use <a title="StructureMap" href="http://docs.structuremap.net/" target="_blank">StructureMap</a>, you must have something like this:</p>
<pre class="brush:csharp">public IContainer CreateContainer()
{
    return new Container(x =&gt;
    {
        x.For&lt;IFoo&gt;().Use&lt;Foo&gt;();
        x.For&lt;IBar&gt;().Use&lt;Bar&gt;();
        x.For&lt;IBaz&gt;().Use&lt;Baz&gt;();
    });
}</pre>
<p>The method could be static. The library will scan the assembly looking for this method and will call it to have the container initialized. After that, it will scan your assembly looking for classes that have a constructor with abstract classes or interfaces as parameters, and it will query the container to see if there's some registration for that type.</p>
<p>So, for example you can have a call like this:</p>
<pre class="brush:csharp">var structureMapTesting = new IoCTestingStructureMap();
var errors = structureMapTesting.CheckDependencies(RegisteringAssemblyPath, RegisteringMethodName, TestingAssemblyPath, NamespaceToScan);
</pre>
<p>As you can see the library takes four parameters:</p>
<ul class="task-list">
<li>The full path of the assembly where the registration is performed.</li>
<li>The qualified name of the class that performs the registration.</li>
<li>The assembly you want to scan</li>
<li>The root namespace you want to scan. Types that its namespace doesn't start with it won't be scanned.</li>
</ul>
<p>And returns an IEnumerable&lt;string&gt; with all the classes or interfaces not registered. Only supports constructor injection, not property injection.</p>
<p>And that's all. I hope it can be useful for you. If you have some issue or comment, please do it in the <a title="IoC Testing Github" href="https://github.com/vgaltes/ioctesting" target="_blank">project page</a>.</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
